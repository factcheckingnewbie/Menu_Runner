import { VerticalBox, HorizontalBox, Button, ListView, ScrollView } from "std-widgets.slint";

export struct MenuEntry {
    label: string,
    actions: [string],
    command-template: string,
}

export component MainWindow inherits Window {
    title: "Menu Runner";
    width: 400px;
    height: 500px;

    callback run_command(string, string);
    in property <[MenuEntry]> menu_items;

    VerticalBox {
        Text {
            text: "Menu Runner";
            font-size: 24px;
            horizontal-alignment: TextHorizontalAlignment.center;
        }

        Rectangle {
            height: 1px;
            background: #ccc;
        }

        ScrollView {
            // This ScrollView will allow scrolling through all menu items
            VerticalBox {
                for menu_item in menu_items: VerticalBox {
                    Text {
                        text: menu_item.label;
                        font-size: 18px;
                        horizontal-alignment: TextHorizontalAlignment.center;
                        padding-top: 10px;
                        padding-bottom: 5px;
                    }

                    HorizontalBox {
                        alignment: LayoutAlignment.center;
                        spacing: 5px;
                        
                        for action in menu_item.actions: Button {
                            text: action;
                            property <string> current-action: action;
                            clicked => {
                                // Explicitly use the action from the loop's current scope
                                root.run_command(menu_item.command-template, self.current-action);
                            }
                        }
                    }

                    Rectangle {
                        height: 1px;
                        background: #eee;
                    }
                }
            }
        }
    }
}
